- Open deadly_arthropod.pcap in Wireshark
- Apply "Leftover Capture Data" as Column
- Apply filter "usb.transfer_type == 0x01 && !(usb.capdata == 00:00:00:00:00:00:00:00)"
- File->Export Packet Dissections->As CSV
- Go to exported file folder, open terminal and run: 

$ cat <exportedfile.csv> | cut -d “,” -f 7 | cut -d “\”” -f 2 | grep -vE “Leftover Capture Data” > hexoutput.txt

- At this point, if you "cat hexoutput.txt" you should have this:

0000080000000000
00000e0000000000
0000160000000000
0200000000000000
02001f0000000000
0200000000000000
00000b0000000000
0000040000000000
0000060000000000
00000e0000000000
0000170000000000
00000b0000000000
0000080000000000
0000050000000000
0000120000000000
00001b0000000000
0000370000000000
0000080000000000
0000180000000000
0000280000000000
0200000000000000
0200170000000000
0200000000000000
00000b0000000000
00001e0000000000
0000160000000000
0200000000000000
0200060000000000
0200000000000000
0000270000000000
0000180000000000
00000f0000000000
0000070000000000
0200000000000000
0200050000000000
0200000000000000
0000200000000000
0200000000000000
0200100000000000
0200000000000000
00001c0000000000
0200000000000000
0200150000000000
0200000000000000
0000200000000000
0000040000000000
00000f0000000000
0200000000000000
0200130000000000
0200000000000000
02001f0000000000
0200000000000000
0000160000000000
0000160000000000
00001a0000000000
0000270000000000
0000150000000000
0000070000000000
0000280000000000
0200000000000000
0200140000000000
0200000000000000
02000e0000000000
0200000000000000
0000500000000000
0200000000000000
02002d0000000000
0200000000000000
00004f0000000000
0000370000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0200000000000000
02000b0000000000
0200000000000000
00004f0000000000
0000220000000000
0000500000000000
0000500000000000
0200000000000000
02002f0000000000
0200000000000000
0200000000000000
02002d0000000000
0200000000000000
0000500000000000
0200000000000000
02000c0000000000
0200000000000000
00004f0000000000
00004f0000000000
0000060000000000
00000e0000000000
00004f0000000000
0000340000000000
00004f0000000000
00004f0000000000
0000050000000000
0000270000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0200000000000000
02000c0000000000
0200000000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0200000000000000
0200170000000000
0200000000000000
00004f0000000000
00004f0000000000
0000090000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
0200000000000000
02002d0000000000
0200000000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
0200000000000000
0200300000000000
0200000000000000
0000500000000000
0000370000000000
0000500000000000
0000370000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000200000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000180000000000
0000500000000000
0000500000000000
0000170000000000
0200000000000000
02002d0000000000
0200000000000000
00004f0000000000
00004f0000000000
0000040000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0200000000000000
0200050000000000
0200000000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
0000170000000000
00004f0000000000
0000220000000000
0000500000000000
0000500000000000
0000500000000000
0200000000000000
02000c0000000000
0200000000000000
00004f0000000000
00004f0000000000
00004f0000000000
0200000000000000
02002d0000000000
0200000000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
0000040000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
0000040000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
00004f0000000000
0000070000000000
0000500000000000
0000500000000000
0000500000000000
0000500000000000
00001c0000000000
00004f0000000000
00004f0000000000
00004f0000000000
0000150000000000

EOF

- Run the following:

$ python USBkeysTranslator.py hexoutput.txt

In the terminal, this should be printed:

"
The keys produced the following text:

eks@hackthebox.eu
Th1sC0uldB3MyR3alP@ssw0rd
HTB{If_It_Quack5_It'5_a_K3yb0ard...}
"

Feel free to try this in other CTFs and let me know how it works!


Reference: https://medium.com/@ali.bawazeeer/kaizen-ctf-2018-reverse-engineer-usb-keystrok-from-pcap-file-2412351679f4
